<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>1% Better. Every Day.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-top: #d2e7dc;
      --bg-bottom: #e3f0e8;
      --accent: #10b981;
      --accent-soft: #a7f3d0;
      --accent-strong: #047857;
      --text-main: #0f172a;
      --text-subtle: #64748b;
      --card-bg: #ffffff;
      --card-border: rgba(15,23,42,0.04);
    }
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "SF Pro Text", sans-serif;
      background: radial-gradient(circle at top left, var(--bg-top), var(--bg-bottom));
      color: var(--text-main);
    }

    .app {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 18px 18px 8px;
      text-align: left;
    }

    .hero-card {
      background: var(--card-bg);
      border-radius: 28px;
      padding: 18px 20px;
      box-shadow: 0 20px 45px rgba(15,23,42,0.10);
      border: 1px solid var(--card-border);
    }

    .hero-row {
      display: flex;
      gap: 14px;
      align-items: center;
    }

    /* 1% logo: sunrise over a wave inside a glowing circle */
    .hero-icon {
      position: relative;
      width: 56px;
      height: 56px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 10%, #fef9c3 0, #facc15 35%, #22c55e 80%);
      border: 2px solid #ffffff;
      box-shadow:
        0 0 0 3px rgba(34, 197, 94, 0.28),
        0 10px 26px rgba(15, 23, 42, 0.35);
      overflow: hidden;
    }
    .hero-icon::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 50% 140%, #0f766e 0, #0f766e 40%, transparent 41%),
        linear-gradient(to top, rgba(15,23,42,0.08), transparent 40%);
    }
    .hero-icon::after {
      content: "";
      position: absolute;
      left: 50%;
      bottom: 46%;
      width: 22px;
      height: 22px;
      transform: translateX(-50%);
      background:
        radial-gradient(circle, #fefce8 0, #facc15 55%, transparent 56%),
        conic-gradient(from 0deg,
          rgba(250, 204, 21, 0.0) 0deg,
          rgba(250, 204, 21, 0.9) 20deg,
          rgba(250, 204, 21, 0.0) 40deg,
          rgba(250, 204, 21, 0.0) 80deg,
          rgba(250, 204, 21, 0.9) 100deg,
          rgba(250, 204, 21, 0.0) 120deg,
          rgba(250, 204, 21, 0.0) 160deg,
          rgba(250, 204, 21, 0.9) 180deg,
          rgba(250, 204, 21, 0.0) 200deg,
          rgba(250, 204, 21, 0.0) 240deg,
          rgba(250, 204, 21, 0.9) 260deg,
          rgba(250, 204, 21, 0.0) 280deg,
          rgba(250, 204, 21, 0.0) 320deg,
          rgba(250, 204, 21, 0.9) 340deg,
          rgba(250, 204, 21, 0.0) 360deg
        );
      border-radius: 999px;
      box-shadow: 0 0 10px rgba(250, 204, 21, 0.9);
    }

    h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .subtitle {
      margin-top: 3px;
      font-size: 13px;
      color: var(--text-subtle);
    }

    .hero-meta {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      font-size: 12px;
      color: var(--text-subtle);
      flex-wrap: wrap;
    }

    .chip {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .chip-strong {
      border-color: var(--accent-soft);
      color: var(--accent-strong);
      background: #ecfdf5;
      font-weight: 600;
    }

    main {
      flex: 1;
      padding: 8px 18px 66px;
    }

    .section-card {
      background: var(--card-bg);
      border-radius: 22px;
      padding: 14px 16px;
      border: 1px solid var(--card-border);
      box-shadow: 0 10px 30px rgba(15,23,42,0.04);
      margin-top: 10px;
    }

    .section-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .section-title {
      font-size: 15px;
      font-weight: 600;
    }

    .section-meta {
      font-size: 12px;
      color: var(--text-subtle);
    }

    .week-bars {
      display: flex;
      gap: 10px;
      align-items: flex-end;
      margin-top: 8px;
      margin-bottom: 6px;
    }

    .week-bar {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
      font-size: 12px;
      color: var(--text-subtle);
      flex: 1;
    }

    .week-pill {
      width: 100%;
      max-width: 26px;
      border-radius: 999px;
      background: #e5f7ed;
      position: relative;
      overflow: hidden;
      height: 42px;
    }
    .week-fill {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 999px;
      background: linear-gradient(180deg,#6ee7b7,#22c55e);
    }

    .small {
      font-size: 12px;
      color: var(--text-subtle);
    }

    .highlight-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .highlight-pill {
      border-radius: 999px;
      border: 1px solid #fee2e2;
      background: #fef2f2;
      font-size: 11px;
      padding: 4px 10px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #b91c1c;
    }

    .highlight-pill span.label {
      color: #4b5563;
      font-weight: 500;
    }

    .smart-item {
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      padding: 8px 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
      background: #f9fafb;
      cursor: pointer;
      transition: background 0.12s, transform 0.08s;
    }

    .smart-item:hover {
      background: #eefdf5;
      transform: translateY(-1px);
    }

    .smart-icon {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: #e5f7ed;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 16px;
      flex-shrink: 0;
    }

    .smart-body { flex: 1; }
    .smart-title { font-size: 14px; font-weight: 600; }
    .smart-sub  { font-size: 12px; color: var(--text-subtle); }

    .smart-meta {
      font-size: 12px;
      text-align: right;
      color: var(--text-subtle);
    }

    .heart { font-size: 12px; }

    .focus-quote {
      font-size: 18px;
      font-weight: 600;
      line-height: 1.4;
      margin-bottom: 6px;
    }

    .field {
      width: 100%;
      padding: 8px 10px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      font-size: 14px;
      background: #f9fafb;
    }

    textarea.field { resize: vertical; min-height: 90px; }

    /* Focus Areas */
    .fa-card {
      border-radius: 16px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      padding: 8px 10px;
      margin-bottom: 8px;
    }
    .fa-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      cursor:pointer;
    }
    .fa-name {
      display:flex;
      align-items:center;
      gap:6px;
      font-size:14px;
      font-weight:600;
    }
    .fa-summary {
      font-size:12px;
      color:var(--text-subtle);
    }
    .fa-toggle {
      font-size:13px;
      color:var(--accent-strong);
    }
    .fa-right {
      display:flex;
      align-items:center;
      gap:6px;
    }
    .fa-tasks {
      margin-top:6px;
      display:none;
    }
    .fa-task {
      display:flex;
      align-items:flex-start;
      gap:8px;
      padding:6px 7px;
      border-radius:12px;
      border:1px solid #e5e7eb;
      background:#ffffff;
      margin-bottom:6px;
      font-size:13px;
    }
    .fa-task-body {
      flex:1;
    }
    .fa-task-title-row {
      display:flex;
      flex-wrap:wrap;
      gap:4px;
      align-items:center;
      font-weight:600;
      margin-bottom:2px;
    }
    .pill {
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#f9fafb;
    }
    .pill-smart {
      border-color:var(--accent-soft);
      color:var(--accent-strong);
      background:#ecfdf5;
      cursor:pointer;
    }
    .fa-task-benefit {
      font-size:12px;
      color:var(--text-subtle);
    }
    .fa-footer {
      margin-top:4px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:12px;
      gap:8px;
      flex-wrap:wrap;
    }
    .linkish{
      font-size:12px;
      color:var(--accent-strong);
      cursor:pointer;
    }

    .trash-btn {
      cursor: pointer;
      font-size: 14px;
      opacity: 0.7;
      transition: opacity 0.15s, transform 0.1s;
    }
    .trash-btn:hover {
      opacity: 1;
      transform: scale(1.15);
    }

    /* Sub-focus sections */
    .fa-sub {
      margin-top: 6px;
      padding-top: 4px;
      border-top: 1px dashed #e5e7eb;
    }
    .fa-sub-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:12px;
      color:var(--text-subtle);
      margin-bottom:4px;
    }
    .fa-sub-name {
      font-weight:600;
      display:flex;
      align-items:center;
      gap:4px;
    }

    /* bottom nav */
    nav {
      position: sticky;
      bottom: 0;
      background: #ffffff;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-around;
      padding: 6px 0 8px;
    }
    .nav-btn {
      flex: 1;
      text-align: center;
      font-size: 12px;
      color: var(--text-subtle);
      cursor: pointer;
    }
    .nav-icon {
      font-size: 19px;
      display: block;
      margin-bottom: 2px;
    }
    .nav-btn.active {
      color: var(--accent-strong);
      font-weight: 600;
    }

    .moods {
      display:flex;
      gap:8px;
      font-size:22px;
      margin-bottom:6px;
    }
    .mood-btn{
      cursor:pointer;
      opacity:.5;
      transition:transform .1s,opacity .1s;
    }
    .mood-btn.active{
      opacity:1;
      transform:scale(1.08);
    }

    .stats-grid {
      display:grid;
      grid-template-columns:repeat(3,minmax(0,1fr));
      gap:8px;
      margin-top:6px;
    }
    .stat-card{
      border-radius:14px;
      border:1px solid #e5e7eb;
      background:#f9fafb;
      padding:8px;
      font-size:12px;
    }
    .stat-label{color:var(--text-subtle);}
    .stat-value{font-weight:700;font-size:15px;margin-top:2px;}

    .calendar{
      display:grid;
      grid-template-columns:repeat(7,1fr);
      gap:4px;
      margin-top:8px;
    }
    .cal-day{
      border-radius:6px;
      padding:3px 2px;
      border:1px solid #e5e7eb;
      font-size:10px;
      text-align:center;
      background:#f9fafb;
      color:var(--text-subtle);
    }

    input[type="date"]{
      border-radius:999px;
      border:1px solid #e5e7eb;
      padding:3px 8px;
      font-size:11px;
      background:#f9fafb;
      color:#4b5563;
    }
  </style>
</head>
<body>
<div class="app">

  <!-- HERO HEADER CARD -->
  <header>
    <div class="hero-card">
      <div class="hero-row">
        <div class="hero-icon" aria-hidden="true"></div>
        <div>
          <h1>1% Better. Every Day.</h1>
          <div class="subtitle">1% shifts. Compounding change.</div>
        </div>
      </div>
      <div class="hero-meta" style="margin-top:12px;">
        <span class="chip"><span id="dateLabel"></span></span>
        <span class="chip chip-strong" id="progressChip">Today: 0% (0/0)</span>
        <span class="chip">
          <span class="small">View date:</span>
          <input id="dateInput" type="date" />
        </span>
      </div>
    </div>
  </header>

  <main>

    <!-- HOME VIEW -->
    <div id="view-home">
      <!-- This week at a glance -->
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">This week at a glance</div>
        </div>
        <div id="weekBars" class="week-bars"></div>
        <div id="weekSummary" class="small"></div>
      </section>

      <!-- Inspirational Quote -->
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Inspirational Quote</div>
        </div>
        <div id="quoteText" class="focus-quote">Loading‚Ä¶</div>
        <div class="small linkish" id="nextQuoteBtn">New quote ‚Üª</div>
      </section>

      <!-- Next up -->
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Next up</div>
          <div class="section-meta" id="smartNowMeta">Next up ‚Ä¢ ‚Äî</div>
        </div>
        <div id="smartNowList"></div>
      </section>

      <!-- Streak highlights -->
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Streak highlights</div>
        </div>
        <div id="streakHighlights" class="highlight-row"></div>
        <div class="small" style="margin-top:6px;">
          Protect your streaks. Even a 1-minute version counts.
        </div>
      </section>
    </div>

    <!-- AREAS VIEW -->
    <div id="view-areas" style="display:none;">
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Focus Areas</div>
          <div class="section-meta linkish" id="addAreaBtn">Ôºã Add focus area</div>
        </div>
        <div id="areasGrid"></div>
      </section>
    </div>

    <!-- CHECK-IN VIEW -->
    <div id="view-checkin" style="display:none;">
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Today's Intention</div>
        </div>
        <input id="morningInput" class="field" placeholder="What is your intention today?" />
      </section>

      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Mood check</div>
        </div>
        <div class="moods">
          <span class="mood-btn" data-mood="angry">üò°</span>
          <span class="mood-btn" data-mood="sad">üòï</span>
          <span class="mood-btn" data-mood="neutral">üòê</span>
          <span class="mood-btn" data-mood="ok">üôÇ</span>
          <span class="mood-btn" data-mood="great">ü§©</span>
        </div>
        <div class="small">Tap how you feel right now.</div>
      </section>

      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Daily reflection</div>
        </div>
        <textarea id="journalInput" class="field" placeholder="What‚Äôs on your mind today?"></textarea>
        <div class="small" style="margin-top:4px;">Saved for this date only.</div>
      </section>

      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Evening gratitude</div>
        </div>
        <input id="eveningInput" class="field" placeholder="What‚Äôs one thing you appreciated today?" />
      </section>
    </div>

    <!-- STATS VIEW -->
    <div id="view-stats" style="display:none;">
      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Your momentum</div>
        </div>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">Streak (approx)</div>
            <div class="stat-value" id="streakValue">0 days</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Minutes this week</div>
            <div class="stat-value" id="minutesValue">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Reps this week</div>
            <div class="stat-value" id="repsValue">0</div>
          </div>
        </div>
      </section>

      <section class="section-card">
        <div class="section-title-row">
          <div class="section-title">Last 14 days</div>
        </div>
        <div id="calendar" class="calendar"></div>
      </section>
    </div>

  </main>

  <nav>
    <div class="nav-btn active" data-view="home">
      <span class="nav-icon">üå§Ô∏è</span>
      <span>Home</span>
    </div>
    <div class="nav-btn" data-view="areas">
      <span class="nav-icon">üéØ</span>
      <span>Areas</span>
    </div>
    <div class="nav-btn" data-view="checkin">
      <span class="nav-icon">‚úçÔ∏è</span>
      <span>Check-In</span>
    </div>
    <div class="nav-btn" data-view="stats">
      <span class="nav-icon">üìä</span>
      <span>Stats</span>
    </div>
  </nav>
</div>

<script>
  // ---------- DATA & HELPERS ----------

  var QUOTES = [
    "The journey of a thousand miles begins with one step.",
    "Momentum beats motivation.",
    "Small shifts create big change.",
    "Each small step is a vote for who you‚Äôre becoming.",
    "Rest is part of progress.",
    "You don‚Äôt need a new life, you need a new day."
  ];

  function timeBlock() {
    var h = new Date().getHours();
    if (h < 10) return "Morning";
    if (h < 14) return "Midday";
    if (h < 18) return "Afternoon";
    if (h < 22) return "Evening";
    return "Night";
  }

  // New Focus Areas: Shoulder, Diet, Exercise, Dance, Wellness,
  // Anya's Creativity Zone, Soundbath, Ciqu, EZ Tool
  var NEW_FOCUS_AREAS = [
    "Shoulder",
    "Diet",
    "Exercise",
    "Dance",
    "Wellness",
    "Anya's Creativity Zone",
    "Soundbath",
    "Ciqu",
    "EZ Tool"
  ];

  var DEFAULT_SUBFOCUS = {
    "Shoulder": ["Mobility", "PT & Rehab"],
    "Diet": ["Fasting", "Meals"],
    "Exercise": ["Strength", "Cardio"],
    "Dance": ["Salsa", "Footwork"],
    "Wellness": ["Cold Plunge", "Breathwork", "Meditation"],
    "Anya's Creativity Zone": ["Setup", "Content"],
    "Soundbath": ["Practice", "Events"],
    "Ciqu": ["Finance", "Operations"],
    "EZ Tool": ["Product", "Marketing"]
  };

  var SUGGESTION_BANK = {
    "Shoulder": [
      { title:"Band external rotations", minutes:3, benefit:"Strengthens shoulder stabilizers", icon:"üè•", blocks:["Morning","Afternoon"] },
      { title:"Wall angels ‚Äì 5 reps", minutes:2, benefit:"Opens upper back & shoulders", icon:"üß±", blocks:["Any"] }
    ],
    "Diet": [
      { title:"Check your fasting window", minutes:1, benefit:"Keeps your 16:8 rhythm on track", icon:"‚è∞", blocks:["Morning"] },
      { title:"Prep one healthy meal", minutes:5, benefit:"Reduces decision fatigue later", icon:"ü•ó", blocks:["Morning","Midday"] }
    ],
    "Exercise": [
      { title:"10 bodyweight squats", minutes:2, benefit:"Activates legs & glutes", icon:"üèãÔ∏è", blocks:["Any"] },
      { title:"10 pushups or wall pushups", minutes:2, benefit:"Builds upper-body strength", icon:"üí™", blocks:["Any"] },
      { title:"Walk 5 minutes", minutes:5, benefit:"Moves blood & clears your head", icon:"üö∂", blocks:["Midday","Afternoon"] }
    ],
    "Dance": [
      { title:"Salsa practice ‚Äì 1 song", minutes:3, benefit:"Drops you into joy & flow", icon:"üíÉ", blocks:["Evening"] },
      { title:"Footwork drill ‚Äì 5 minutes", minutes:5, benefit:"Builds confidence on the floor", icon:"ü¶∂", blocks:["Evening"] }
    ],
    "Wellness": [
      { title:"Cold plunge ‚Äì 2 minutes", minutes:2, benefit:"Boosts dopamine & grit", icon:"‚ùÑÔ∏è", blocks:["Morning"] },
      { title:"Wim Hof ‚Äì 1 light round", minutes:5, benefit:"Boosts focus & calm", icon:"üå¨Ô∏è", blocks:["Morning"] },
      { title:"Meditate ‚Äì 5 minutes", minutes:5, benefit:"Calms your nervous system", icon:"üßò", blocks:["Morning","Evening"] }
    ],
    "Anya's Creativity Zone": [
      { title:"Tidy one small zone", minutes:5, benefit:"Keeps the creative space inviting", icon:"üßπ", blocks:["Any"] },
      { title:"Brainstorm 1 video idea", minutes:5, benefit:"Moves her channel 1% forward", icon:"üé•", blocks:["Afternoon","Evening"] }
    ],
    "Soundbath": [
      { title:"5-min instrument practice", minutes:5, benefit:"Deepens your sound mastery", icon:"üé∂", blocks:["Any"] },
      { title:"Curate 1 new track for playlist", minutes:3, benefit:"Keeps your sets fresh", icon:"üéß", blocks:["Evening"] }
    ],
    "Ciqu": [
      { title:"Review payables list", minutes:5, benefit:"Keeps vendors current & calm", icon:"üìë", blocks:["Midday"] },
      { title:"Update one project line item", minutes:3, benefit:"Keeps financials accurate", icon:"üìä", blocks:["Afternoon"] }
    ],
    "EZ Tool": [
      { title:"Check one tool status", minutes:3, benefit:"Keeps inventory accurate", icon:"üõ†Ô∏è", blocks:["Any"] },
      { title:"One tiny marketing step", minutes:5, benefit:"Keeps brand awareness growing", icon:"üì£", blocks:["Afternoon","Evening"] }
    ],
    "_default": [
      { title:"Take 3 slow breaths", minutes:1, benefit:"Recenters your energy", icon:"üå¨Ô∏è", blocks:["Any"] }
    ]
  };

  // Updated default actions mapped into new Focus Areas + sub-focus
  var DEFAULT_ACTIONS = [
    // Shoulder
    { id:"a1",  area:"Shoulder", subArea:"Mobility",      title:"Shoulder mobility circles", minutes:2,  benefit:"Keeps the joint moving smoothly", favorite:true,  blocks:["Morning","Afternoon"], icon:"üîÑ" },
    { id:"a2",  area:"Shoulder", subArea:"PT & Rehab",    title:"Band external rotations",   minutes:3,  benefit:"Strengthens stabilizers & rehab", favorite:false, blocks:["Afternoon"],           icon:"üè•" },

    // Diet
    { id:"a3",  area:"Diet",     subArea:"Fasting",       title:"Check today's fasting window", minutes:1, benefit:"Keeps your 16:8 dialed in", favorite:true,  blocks:["Morning"],           icon:"‚è∞" },
    { id:"a4",  area:"Diet",     subArea:"Meals",         title:"Plan one healthy meal",        minutes:3, benefit:"Removes decision fatigue later", favorite:false, blocks:["Morning","Midday"], icon:"ü•ó" },

    // Exercise
    { id:"a5",  area:"Exercise", subArea:"Strength",      title:"Strength training ‚Äì 20 min",  minutes:20, benefit:"Builds strength & resilience", favorite:true, blocks:["Afternoon"],          icon:"üèãÔ∏è" },
    { id:"a6",  area:"Exercise", subArea:"Strength",      title:"10 bodyweight squats",        minutes:2,  benefit:"Activates legs & glutes",      favorite:false, blocks:["Any"],               icon:"üèÉ" },

    // Dance
    { id:"a7",  area:"Dance",    subArea:"Salsa",         title:"Salsa practice ‚Äì 1 song",     minutes:3,  benefit:"Drops you into joy & flow",    favorite:true,  blocks:["Evening"],           icon:"üíÉ" },
    { id:"a8",  area:"Dance",    subArea:"Footwork",      title:"Footwork drill ‚Äì 5 min",      minutes:5,  benefit:"Builds confidence on the floor", favorite:false, blocks:["Evening"],         icon:"ü¶∂" },

    // Wellness
    { id:"a9",  area:"Wellness", subArea:"Cold Plunge",   title:"Cold plunge ‚Äì 2 min",         minutes:2,  benefit:"Boosts dopamine & grit",        favorite:true,  blocks:["Morning"],           icon:"‚ùÑÔ∏è" },
    { id:"a10", area:"Wellness", subArea:"Breathwork",    title:"Wim Hof ‚Äì 3 rounds",          minutes:11, benefit:"Oxygenates body & clears mind", favorite:false, blocks:["Morning"],          icon:"üå¨Ô∏è" },

    // Anya's Creativity Zone
    { id:"a11", area:"Anya's Creativity Zone", subArea:"Setup",   title:"Tidy one corner of the zone", minutes:5,  benefit:"Keeps her space inspiring", favorite:true,  blocks:["Any"],         icon:"üßπ" },
    { id:"a12", area:"Anya's Creativity Zone", subArea:"Content", title:"Brainstorm 1 video idea",     minutes:5,  benefit:"Moves her channel 1% forward", favorite:false, blocks:["Afternoon","Evening"], icon:"üé•" },

    // Soundbath
    { id:"a13", area:"Soundbath", subArea:"Practice",    title:"5-min sound practice",          minutes:5,  benefit:"Deepens your sound mastery",    favorite:true,  blocks:["Any"],               icon:"üé∂" },
    { id:"a14", area:"Soundbath", subArea:"Events",      title:"Curate 1 new playlist track",   minutes:3,  benefit:"Keeps your sets feeling fresh", favorite:false, blocks:["Evening"],          icon:"üéß" },

    // Ciqu
    { id:"a15", area:"Ciqu",      subArea:"Finance",     title:"Review today's payables",       minutes:5,  benefit:"Keeps vendors current & calm",  favorite:true,  blocks:["Midday"],           icon:"üìë" },
    { id:"a16", area:"Ciqu",      subArea:"Operations",  title:"Update 1 project note",         minutes:3,  benefit:"Keeps project status clear",    favorite:false, blocks:["Afternoon"],        icon:"üìä" },

    // EZ Tool
    { id:"a17", area:"EZ Tool",   subArea:"Product",     title:"Review one tool in inventory",  minutes:3,  benefit:"Keeps inventory accurate",      favorite:true,  blocks:["Any"],               icon:"üõ†Ô∏è" },
    { id:"a18", area:"EZ Tool",   subArea:"Marketing",   title:"One tiny marketing step",       minutes:5,  benefit:"Keeps awareness growing",       favorite:false, blocks:["Afternoon","Evening"], icon:"üì£" }
  ];

  var STORAGE_KEY = "onepct_layout_v4_home_areas_split";
  var state;
  try { state = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); }
  catch(e){ state = {}; }

  // --------- STATE INIT / MIGRATION ---------
  if (!Array.isArray(state.actions)) state.actions = DEFAULT_ACTIONS.slice();
  if (!state.days) state.days = {};
  if (typeof state.quoteIndex !== "number") state.quoteIndex = 0;

  // migrate old areas (Health/Breathwork/etc) to new focus areas
  var oldAreas = ["Health","Breathwork","Movement","Fitness","Spiritual","Family","Career","Fun"];
  var hasOldArea = Array.isArray(state.areas) && state.areas.some(function(a){ return oldAreas.indexOf(a) >= 0; });
  if (!Array.isArray(state.areas) || hasOldArea) {
    state.areas = NEW_FOCUS_AREAS.slice();
    // also reset actions if they were using the old template
    var hasOldActions = Array.isArray(state.actions) && state.actions.some(function(a){ return oldAreas.indexOf(a.area) >= 0; });
    if (hasOldActions) {
      state.actions = DEFAULT_ACTIONS.slice();
    }
  }

  if (!state.subAreas || typeof state.subAreas !== "object") state.subAreas = {};
  // seed default sub-focus lists
  for (var k in DEFAULT_SUBFOCUS) {
    if (!Array.isArray(state.subAreas[k])) {
      state.subAreas[k] = DEFAULT_SUBFOCUS[k].slice();
    }
  }

  var todayISO = new Date().toISOString().slice(0,10);
  var currentDate = state.currentDate || todayISO;

  var expandedAreas = {};

  function ensureDay(date){
    if (!state.days[date]) state.days[date] = { done:{}, morning:"", evening:"", journal:"", mood:null };
    return state.days[date];
  }

  function saveState(){
    state.currentDate = currentDate;
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }catch(e){}
  }

  function formatDateLabel(date){
    var d = new Date(date);
    return d.toLocaleDateString(undefined,{weekday:"short", month:"short", day:"numeric"});
  }

  function getActions(){
    if (!Array.isArray(state.actions) || !state.actions.length) state.actions = DEFAULT_ACTIONS.slice();
    return state.actions;
  }

  function generateSuggestionForArea(area){
    var bank = SUGGESTION_BANK[area] || SUGGESTION_BANK._default || [];
    if (!bank.length) {
      alert("No ideas available yet for this area.");
      return;
    }
    var existing = getActions().filter(function(a){ return a.area === area; });
    var picked = null;
    for (var i=0;i<bank.length;i++){
      var s = bank[i];
      var found = existing.some(function(a){ return a.title === s.title; });
      if (!found){
        picked = s;
        break;
      }
    }
    if (!picked){
      alert("You‚Äôve already added all the ideas I have for this area.");
      return;
    }
    var id = "g" + Date.now() + Math.floor(Math.random()*1000);
    state.actions.push({
      id:id,
      area:area,
      subArea:(state.subAreas[area] && state.subAreas[area][0]) || "General",
      title:picked.title,
      benefit:picked.benefit,
      minutes:picked.minutes,
      favorite:false,
      icon:picked.icon,
      blocks:picked.blocks
    });
    saveState();
    render();
  }

  // ---------- DOM REFS ----------

  var dateLabel       = document.getElementById("dateLabel");
  var progressChip    = document.getElementById("progressChip");
  var dateInput       = document.getElementById("dateInput");

  var weekBars        = document.getElementById("weekBars");
  var weekSummary     = document.getElementById("weekSummary");

  var streakHighlights= document.getElementById("streakHighlights");
  var smartNowList    = document.getElementById("smartNowList");
  var smartNowMeta    = document.getElementById("smartNowMeta");

  var quoteText       = document.getElementById("quoteText");
  var nextQuoteBtn    = document.getElementById("nextQuoteBtn");
  var morningInput    = document.getElementById("morningInput");

  var areasGrid       = document.getElementById("areasGrid");
  var addAreaBtn      = document.getElementById("addAreaBtn");

  var journalInput    = document.getElementById("journalInput");
  var eveningInput    = document.getElementById("eveningInput");
  var moodButtons     = document.querySelectorAll(".mood-btn");

  var streakValue     = document.getElementById("streakValue");
  var minutesValue    = document.getElementById("minutesValue");
  var repsValue       = document.getElementById("repsValue");
  var calendarEl      = document.getElementById("calendar");

  // ---------- RENDER ----------

  function render(){
    var day = ensureDay(currentDate);
    dateInput.value = currentDate;
    dateLabel.textContent = formatDateLabel(currentDate);

    morningInput.value = day.morning || "";
    eveningInput.value = day.evening || "";
    journalInput.value = day.journal || "";

    if (state.quoteIndex < 0) state.quoteIndex = 0;
    if (state.quoteIndex >= QUOTES.length) state.quoteIndex = QUOTES.length-1;
    quoteText.textContent = "‚Äú" + QUOTES[state.quoteIndex] + "‚Äù";

    moodButtons.forEach(function(btn){
      btn.classList.toggle("active", btn.dataset.mood === day.mood);
    });

    renderProgress(day);
    renderWeekGlance();
    renderStreakHighlights();
    renderSmartNow(day);
    renderAreasToday(day);
    renderStats();
    renderCalendar();
  }

  function renderProgress(day){
    var actions = getActions();
    var total = actions.length;
    var done = actions.filter(function(a){ return day.done[a.id]; }).length;
    var pct = total ? Math.round(done/total*100) : 0;
    progressChip.textContent = "Today: " + pct + "% ("+done+"/"+total+")";
  }

  function renderWeekGlance(){
    weekBars.innerHTML = "";
    var actions = getActions();
    if (!actions.length){
      weekSummary.textContent = "Add a few 1% steps to start your rhythm.";
      return;
    }
    var base = new Date(currentDate);
    var dayOfWeek = base.getDay();
    var monday = new Date(base);
    monday.setDate(base.getDate() - ((dayOfWeek + 6) % 7));
    var completions = [];
    for (var i=0;i<7;i++){
      var d = new Date(monday);
      d.setDate(monday.getDate()+i);
      var key = d.toISOString().slice(0,10);
      var day = state.days[key] || {done:{}};
      var total = actions.length || 1;
      var done = actions.filter(function(a){ return day.done[a.id]; }).length;
      var pct = Math.round(done/total*100);
      completions.push({date:key,pct:pct});
    }

    completions.forEach(function(info,i){
      var bar = document.createElement("div");
      bar.className = "week-bar";
      var pill = document.createElement("div");
      pill.className = "week-pill";
      var fill = document.createElement("div");
      fill.className = "week-fill";
      fill.style.height = Math.max(0,Math.min(100, info.pct)) + "%";
      pill.appendChild(fill);
      var label = document.createElement("div");
      label.textContent = ["M","T","W","T","F","S","S"][i];
      bar.appendChild(pill);
      bar.appendChild(label);
      weekBars.appendChild(bar);
    });

    var activeDays = completions.filter(function(c){ return c.pct >= 50; }).length;
    weekSummary.textContent = activeDays + " of 7 days at 50%+. You‚Äôre building a gentle rhythm.";
  }

  function computeActionStreak(actionId){
    var streak = 0;
    var cursor = new Date(currentDate);
    while (true){
      var key = cursor.toISOString().slice(0,10);
      var day = state.days[key];
      if (!day) break;
      var done = day.done && day.done[actionId];
      if (!done) break;
      streak++;
      cursor.setDate(cursor.getDate()-1);
    }
    return streak;
  }

  function renderStreakHighlights(){
    streakHighlights.innerHTML = "";
    var actions = getActions();
    var streaks = actions.map(function(a){ return {action:a, streak:computeActionStreak(a.id)}; })
                         .filter(function(x){ return x.streak>0; })
                         .sort(function(a,b){ return b.streak-a.streak; })
                         .slice(0,3);

    if (!streaks.length){
      streakHighlights.innerHTML = '<span class="small">Complete one 1% action today to start your streaks.</span>';
      return;
    }

    streaks.forEach(function(s){
      var pill = document.createElement("div");
      pill.className = "highlight-pill";
      pill.innerHTML = "‚ö° <span class='label'>" +
        s.action.title.replace(/ ‚Äì.*/,"") +
        "</span> ‚Äì " + s.streak + " day" + (s.streak===1?"":"s");
      streakHighlights.appendChild(pill);
    });
  }

  function renderSmartNow(day){
    smartNowList.innerHTML = "";
    var block = timeBlock();
    smartNowMeta.textContent = "Next up ‚Ä¢ " + block;
    var actions = getActions();
    if (!actions.length){
      smartNowList.innerHTML = "<div class='small'>Add a few 1% steps in your focus areas first.</div>";
      return;
    }

    var undone = actions.filter(function(a){ return !day.done[a.id]; });
    var pool = undone.length ? undone : actions.slice();
    pool = pool.filter(function(a){
      if (!a.blocks || !a.blocks.length) return true;
      if (a.blocks.indexOf("Any") >= 0) return true;
      return a.blocks.indexOf(block)>=0;
    });
    pool.sort(function(a,b){
      var sa = (a.favorite?2:0);
      var sb = (b.favorite?2:0);
      return sb-sa;
    });

    pool.slice(0,5).forEach(function(a){
      var row = document.createElement("div");
      row.className = "smart-item";

      row.addEventListener("click", function(){
        var d = ensureDay(currentDate);
        d.done[a.id] = !d.done[a.id];
        saveState();
        render();
      });

      var ic = document.createElement("div");
      ic.className = "smart-icon";
      ic.textContent = a.icon || "‚ú®";

      var body = document.createElement("div");
      body.className = "smart-body";
      var title = document.createElement("div");
      title.className = "smart-title";
      title.textContent = a.title.replace(/ ‚Äì.*/,"");
      var sub = document.createElement("div");
      sub.className = "smart-sub";
      sub.textContent = a.benefit || "";
      body.appendChild(title);
      body.appendChild(sub);

      var meta = document.createElement("div");
      meta.className = "smart-meta";
      meta.innerHTML = (a.minutes||1) + " min<br>" + (a.favorite?'<span class="heart">‚ô•</span>':"&nbsp;");

      row.appendChild(ic);
      row.appendChild(body);
      row.appendChild(meta);
      smartNowList.appendChild(row);
    });
  }

  function renderAreasToday(day){
    areasGrid.innerHTML = "";
    var actions = getActions();

    // Build nested structure: area -> subArea -> [tasks]
    var byArea = {};
    actions.forEach(function(a){
      var area = a.area || "General";
      var sub = a.subArea || "General";
      if (!byArea[area]) byArea[area] = {};
      if (!byArea[area][sub]) byArea[area][sub] = [];
      byArea[area][sub].push(a);
    });

    // Merge areas: from state.areas + discovered
    var areaSet = {};
    (state.areas || []).forEach(function(a){ areaSet[a] = true; });
    Object.keys(byArea).forEach(function(a){ areaSet[a] = true; });

    var areaNames = [];
    (state.areas || []).forEach(function(a){
      if (areaSet[a]) {
        areaNames.push(a);
        delete areaSet[a];
      }
    });
    Object.keys(areaSet).sort().forEach(function(a){ areaNames.push(a); });

    areaNames.forEach(function(area){
      var subMap = byArea[area] || {};
      var subsFromState = state.subAreas[area] || [];
      // ensure we include any subs that only exist because of tasks
      Object.keys(subMap).forEach(function(s){
        if (subsFromState.indexOf(s) === -1) subsFromState.push(s);
      });
      if (!subsFromState.length) subsFromState = ["General"];

      // compute totals
      var allTasks = [];
      subsFromState.forEach(function(s){
        var arr = subMap[s] || [];
        allTasks = allTasks.concat(arr);
      });
      var total = allTasks.length;
      var doneCount = allTasks.filter(function(a){ return day.done[a.id]; }).length;
      var pct = total ? Math.round(doneCount/total*100) : 0;

      var card = document.createElement("div");
      card.className = "fa-card";

      var header = document.createElement("div");
      header.className = "fa-header";

      var name = document.createElement("div");
      name.className = "fa-name";
      name.innerHTML = "<span>üíö</span><span>"+area+"</span>";

      var right = document.createElement("div");
      right.className = "fa-right";

      var summary = document.createElement("span");
      summary.className = "fa-summary";
      summary.textContent = doneCount+" / "+total+" ‚Ä¢ "+pct+"%";

      var delArea = document.createElement("span");
      delArea.className = "trash-btn";
      delArea.innerHTML = "üóëÔ∏è";
      delArea.title = "Delete focus area";
      delArea.addEventListener("click", function(ev){
        ev.stopPropagation();
        if (!confirm("Delete focus area '" + area + "' and all its tasks?")) return;

        if (Array.isArray(state.areas)) {
          state.areas = state.areas.filter(function(aName){ return aName !== area; });
        }

        var ids = allTasks.map(function(t){ return t.id; });

        state.actions = state.actions.filter(function(a){ return a.area !== area; });

        Object.keys(state.days).forEach(function(k){
          var d = state.days[k];
          if (!d || !d.done) return;
          ids.forEach(function(id){
            if (d.done[id]) delete d.done[id];
          });
        });

        delete state.subAreas[area];
        delete expandedAreas[area];
        saveState();
        render();
      });

      var toggle = document.createElement("span");
      toggle.className = "fa-toggle";
      toggle.textContent = expandedAreas[area] ? "‚ñ¥" : "‚ñæ";

      right.appendChild(summary);
      right.appendChild(delArea);
      right.appendChild(toggle);

      header.appendChild(name);
      header.appendChild(right);

      var tasksEl = document.createElement("div");
      tasksEl.className = "fa-tasks";
      if (expandedAreas[area]) tasksEl.style.display = "block";

      // Render sub-focus sections
      subsFromState.forEach(function(subName){
        var subBox = document.createElement("div");
        subBox.className = "fa-sub";

        var subHeader = document.createElement("div");
        subHeader.className = "fa-sub-header";

        var subTitle = document.createElement("div");
        subTitle.className = "fa-sub-name";
        subTitle.innerHTML = "<span>‚§∑</span><span>"+subName+"</span>";

        var subDel = document.createElement("span");
        subDel.className = "trash-btn";
        subDel.innerHTML = "üóëÔ∏è";
        subDel.title = "Delete sub-focus";
        subDel.addEventListener("click", function(ev){
          ev.stopPropagation();
          if (!confirm("Delete sub-focus '"+subName+"' and its tasks in "+area+"?")) return;

          var subTasks = (subMap[subName] || []).map(function(t){ return t.id; });

          state.actions = state.actions.filter(function(a){
            return !(a.area === area && (a.subArea || "General") === subName);
          });

          Object.keys(state.days).forEach(function(k){
            var d = state.days[k];
            if (!d || !d.done) return;
            subTasks.forEach(function(id){
              if (d.done[id]) delete d.done[id];
            });
          });

          if (Array.isArray(state.subAreas[area])) {
            state.subAreas[area] = state.subAreas[area].filter(function(s){ return s !== subName; });
          }

          saveState();
          render();
        });

        subHeader.appendChild(subTitle);
        subHeader.appendChild(subDel);

        subBox.appendChild(subHeader);

        var tasksInSub = subMap[subName] || [];
        tasksInSub.forEach(function(task){
          var row = document.createElement("div");
          row.className = "fa-task";

          var cb = document.createElement("input");
          cb.type = "checkbox";
          cb.checked = !!day.done[task.id];
          cb.addEventListener("change", function(){
            ensureDay(currentDate).done[task.id] = cb.checked;
            saveState();
            render();
          });

          var body = document.createElement("div");
          body.className = "fa-task-body";

          var titleRow = document.createElement("div");
          titleRow.className = "fa-task-title-row";
          var titleSpan = document.createElement("span");
          titleSpan.textContent = task.title.replace(/ ‚Äì.*/,"");
          titleRow.appendChild(titleSpan);

          var mins = document.createElement("span");
          mins.className = "pill";
          mins.textContent = (task.minutes || 1) + " min";
          titleRow.appendChild(mins);

          var smart = document.createElement("span");
          smart.className = "pill pill-smart";
          smart.textContent = task.favorite ? "Smart Now ‚úì" : "Add to Smart Now";
          smart.addEventListener("click", function(ev){
            ev.preventDefault();
            ev.stopPropagation();
            task.favorite = !task.favorite;
            saveState();
            render();
          });
          titleRow.appendChild(smart);

          var benefit = document.createElement("div");
          benefit.className = "fa-task-benefit";
          benefit.textContent = task.benefit || "";

          body.appendChild(titleRow);
          body.appendChild(benefit);

          var del = document.createElement("span");
          del.className = "trash-btn";
          del.innerHTML = "üóëÔ∏è";
          del.title = "Delete task";
          del.addEventListener("click", function(ev){
            ev.stopPropagation();
            if (!confirm("Remove this task from " + area + " / " + subName + "?")) return;
            state.actions = state.actions.filter(function(a){ return a.id !== task.id; });
            Object.keys(state.days).forEach(function(k){
              var d = state.days[k];
              if (d && d.done && d.done[task.id]) delete d.done[task.id];
            });
            saveState();
            render();
          });

          row.appendChild(cb);
          row.appendChild(body);
          row.appendChild(del);

          subBox.appendChild(row);
        });

        tasksEl.appendChild(subBox);
      });

      var footer = document.createElement("div");
      footer.className = "fa-footer";

      var add = document.createElement("span");
      add.className = "linkish";
      add.textContent = "+ Add task";
      add.addEventListener("click", function(ev){
        ev.stopPropagation();
        var title = prompt("New 1% task for "+area+"?");
        if (!title) return;
        title = title.trim();
        if (!title) return;

        var subs = state.subAreas[area] || [];
        if (!subs.length) subs = ["General"];

        var subName = "General";
        if (subs.length === 1) {
          subName = subs[0];
        } else {
          var choice = prompt("Which sub-focus? ("+subs.join(", ")+")\nOr type a new one.");
          if (!choice) return;
          choice = choice.trim();
          subName = choice;
          if (!state.subAreas[area]) state.subAreas[area] = [];
          if (state.subAreas[area].indexOf(choice) === -1) {
            state.subAreas[area].push(choice);
          }
        }

        var m = parseInt(prompt("Minutes (number)?") || "3",10);
        if (!m || m<1) m = 3;
        var benefit = prompt("Short benefit line (optional):") || "Supports your long-term vision.";
        var id = "u" + Date.now() + Math.floor(Math.random()*1000);
        state.actions.push({
          id:id, area:area, subArea:subName, title:title, benefit:benefit,
          minutes:m, favorite:false
        });
        saveState();
        render();
      });

      var ideas = document.createElement("span");
      ideas.className = "linkish";
      ideas.textContent = "+ Add suggestion";
      ideas.addEventListener("click", function(ev){
        ev.stopPropagation();
        generateSuggestionForArea(area);
      });

      var addSub = document.createElement("span");
      addSub.className = "linkish";
      addSub.textContent = "+ Add sub-focus";
      addSub.addEventListener("click", function(ev){
        ev.stopPropagation();
        var name = prompt("New sub-focus for "+area+"?");
        if (!name) return;
        name = name.trim();
        if (!name) return;
        if (!state.subAreas[area]) state.subAreas[area] = [];
        if (state.subAreas[area].indexOf(name) === -1) {
          state.subAreas[area].push(name);
        }
        saveState();
        render();
      });

      footer.appendChild(add);
      footer.appendChild(ideas);
      footer.appendChild(addSub);

      card.appendChild(header);
      card.appendChild(tasksEl);
      card.appendChild(footer);

      header.addEventListener("click", function(){
        expandedAreas[area] = !expandedAreas[area];
        render();
      });

      areasGrid.appendChild(card);
    });
  }

  function renderStats(){
    var dates = Object.keys(state.days).sort();
    var streak = 0;
    if (dates.length){
      var cursor = new Date(currentDate);
      while (true){
        var key = cursor.toISOString().slice(0,10);
        var day = state.days[key];
        if (!day) break;
        var any = Object.values(day.done||{}).some(Boolean);
        if (!any) break;
        streak++;
        cursor.setDate(cursor.getDate()-1);
      }
    }
    streakValue.textContent = streak + " day" + (streak===1?"":"s");

    var base = new Date(currentDate);
    var dow = base.getDay();
    var monday = new Date(base);
    monday.setDate(base.getDate() - ((dow+6)%7));
    var sunday = new Date(monday);
    sunday.setDate(monday.getDate()+6);

    var mins = 0;
    var reps = 0;
    var actions = getActions();
    for (var d=new Date(monday); d<=sunday; d.setDate(d.getDate()+1)){
      var key = d.toISOString().slice(0,10);
      var day = state.days[key];
      if (!day) continue;
      actions.forEach(function(a){
        if (day.done[a.id]){
          mins += (a.minutes||0);
          if (a.reps) reps += a.reps;
        }
      });
    }
    minutesValue.textContent = mins;
    repsValue.textContent = reps;
  }

  function renderCalendar(){
    calendarEl.innerHTML = "";
    var actions = getActions();
    for (var i=13;i>=0;i--){
      var d = new Date();
      d.setDate(d.getDate()-i);
      var key = d.toISOString().slice(0,10);
      var day = state.days[key] || {done:{}};
      var total = actions.length||1;
      var done = actions.filter(function(a){ return day.done[a.id]; }).length;
      var pct = Math.round(done/total*100);
      var cell = document.createElement("div");
      cell.className = "cal-day";
      cell.textContent = pct + "%";
      var light = 100 - Math.round(pct*0.4);
      cell.style.background = "hsl(140,60%,"+light+"%)";
      calendarEl.appendChild(cell);
    }
  }

  // ---------- EVENTS ----------

  dateInput.addEventListener("change", function(){
    currentDate = dateInput.value || todayISO;
    ensureDay(currentDate);
    saveState();
    render();
  });

  nextQuoteBtn.addEventListener("click", function(){
    state.quoteIndex = (state.quoteIndex + 1) % QUOTES.length;
    saveState();
    render();
  });

  morningInput.addEventListener("input", function(){
    ensureDay(currentDate).morning = morningInput.value;
    saveState();
  });
  eveningInput.addEventListener("input", function(){
    ensureDay(currentDate).evening = eveningInput.value;
    saveState();
  });
  journalInput.addEventListener("input", function(){
    ensureDay(currentDate).journal = journalInput.value;
    saveState();
  });

  moodButtons.forEach(function(btn){
    btn.addEventListener("click", function(){
      ensureDay(currentDate).mood = btn.dataset.mood;
      saveState();
      render();
    });
  });

  var views = {
    home:    document.getElementById("view-home"),
    areas:   document.getElementById("view-areas"),
    checkin: document.getElementById("view-checkin"),
    stats:   document.getElementById("view-stats")
  };
  var navBtns = document.querySelectorAll(".nav-btn");
  navBtns.forEach(function(btn){
    btn.addEventListener("click", function(){
      var v = btn.dataset.view;
      Object.keys(views).forEach(function(k){
        views[k].style.display = (k===v) ? "block" : "none";
      });
      navBtns.forEach(function(b){ b.classList.toggle("active", b===btn); });
    });
  });

  addAreaBtn.addEventListener("click", function(){
    var name = prompt("New focus area name (e.g., Travel, Creativity, Recovery)?");
    if (!name) return;
    name = name.trim();
    if (!name) return;
    if (!state.areas) state.areas = [];
    if (state.areas.indexOf(name) === -1) {
      state.areas.push(name);
    }
    if (!state.subAreas[name]) {
      state.subAreas[name] = ["General"];
    }
    saveState();
    render();
  });

  // ---------- INIT ----------
  dateInput.value = currentDate;
  render();
</script>
</body>
</html>
