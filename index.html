<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>1% Better. Every Day.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-top: #e6fbf4;
      --bg-bottom: #ffffff;
      --accent: #10b981;
      --accent-soft: #a7f3d0;
      --accent-strong: #047857;
      --text-main: #0f172a;
      --text-subtle: #64748b;
      --card-bg: #ffffff;
      --card-border: rgba(15,23,42,0.06);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "SF Pro Text", sans-serif;
      background: linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bottom) 40%);
      color: var(--text-main);
    }
    .app {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 16px 14px 8px;
      text-align: center;
    }
    .sunrise-icon {
      font-size: 26px;
      margin-bottom: 4px;
    }
    h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 800;
    }
    .subtitle {
      margin-top: 2px;
      font-size: 12px;
      color: var(--text-subtle);
    }
    .header-meta {
      margin-top: 8px;
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
      font-size: 12px;
      color: var(--text-subtle);
    }
    .chip {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #ffffffaa;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .chip-strong {
      border-color: var(--accent-soft);
      color: var(--accent-strong);
      background: #ecfdf5;
      font-weight: 600;
    }
    main {
      flex: 1;
      padding: 0 14px 60px;
    }
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--card-border);
      box-shadow: 0 14px 30px rgba(15,23,42,0.08);
      padding: 12px 14px;
      margin-bottom: 12px;
    }
    .label-sm {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .06em;
      color: var(--text-subtle);
      margin-bottom: 4px;
    }
    .quote {
      font-size: 16px;
      margin-bottom: 6px;
    }
    .small {
      font-size: 11px;
      color: var(--text-subtle);
    }
    .btn {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      padding: 4px 10px;
      font-size: 12px;
      background: #ffffff;
      cursor: pointer;
    }
    .btn:active { background: #f1f5f9; }
    .btn-primary {
      border-radius: 999px;
      border: 1px solid var(--accent);
      padding: 6px 12px;
      font-size: 13px;
      background: var(--accent);
      color: #ffffff;
      cursor: pointer;
    }
    .field {
      width: 100%;
      padding: 7px 10px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      font-size: 13px;
    }
    .field-area {
      width: 100%;
      padding: 6px 8px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      font-size: 12px;
    }
    .row {
      display: flex;
      gap: 6px;
    }
    .row-space {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }
    .row-wrap {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }
    .next-item {
      font-size: 13px;
      padding: 7px 8px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 5px;
    }
    .next-item-title {
      font-weight: 600;
      margin-bottom: 2px;
    }
    .next-side {
      text-align: right;
      font-size: 11px;
      color: var(--text-subtle);
    }
    .badge-focus {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      background: #ecfdf5;
      color: var(--accent-strong);
      border: 1px solid #bbf7d0;
      display: inline-block;
      margin-top: 2px;
    }
    .area-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      margin-bottom: 4px;
    }
    .area-title {
      font-weight: 600;
      font-size: 14px;
    }
    .area-meta {
      font-size: 11px;
      color: var(--text-subtle);
    }
    .task {
      display: flex;
      gap: 8px;
      padding: 7px 9px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #ffffff;
      margin-bottom: 6px;
      font-size: 13px;
    }
    .task-body {
      flex: 1;
    }
    .task-title-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      align-items: center;
      font-weight: 600;
      margin-bottom: 2px;
    }
    .task-benefit {
      font-size: 11px;
      color: var(--text-subtle);
    }
    .pill {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
    }
    .pill-fav {
      border-color: var(--accent-soft);
      color: var(--accent-strong);
      background: #ecfdf5;
    }
    textarea.field {
      resize: vertical;
      min-height: 100px;
    }
    .moods {
      display: flex;
      gap: 6px;
      font-size: 20px;
      margin-bottom: 6px;
    }
    .mood-btn {
      cursor: pointer;
      opacity: 0.5;
      transition: transform 0.1s, opacity 0.1s;
    }
    .mood-btn.active {
      opacity: 1;
      transform: scale(1.1);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 6px;
      margin-bottom: 8px;
    }
    .stat-card {
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      padding: 6px 8px;
      font-size: 11px;
      text-align: left;
    }
    .stat-label {
      color: var(--text-subtle);
      margin-bottom: 2px;
    }
    .stat-value {
      font-weight: 700;
      font-size: 13px;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 4px;
      margin-top: 6px;
    }
    .cal-day {
      border-radius: 6px;
      padding: 2px;
      border: 1px solid #e5e7eb;
      font-size: 9px;
      text-align: center;
      background: #f9fafb;
      color: var(--text-subtle);
    }

    nav {
      position: sticky;
      bottom: 0;
      background: #ffffff;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-around;
      padding: 6px 0 8px;
    }
    .nav-btn {
      flex: 1;
      text-align: center;
      font-size: 11px;
      color: var(--text-subtle);
      cursor: pointer;
    }
    .nav-icon {
      font-size: 18px;
      display: block;
      margin-bottom: 2px;
    }
    .nav-btn.active {
      color: var(--accent-strong);
      font-weight: 600;
    }

    input[type="date"] {
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      padding: 3px 8px;
      font-size: 11px;
      background: #ffffff;
      color: var(--text-subtle);
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="sunrise-icon">üå§Ô∏è</div>
      <h1>1% Better. Every Day.</h1>
      <div class="subtitle">Tiny actions. Consistent momentum. Compounding results.</div>
      <div class="header-meta">
        <span class="chip"><span id="dateLabel"></span></span>
        <span class="chip chip-strong" id="progressChip">Today: 0% (0/0)</span>
      </div>
      <div class="header-meta">
        <span class="chip">
          <span class="small">Time:</span>
          <span id="timeBlockLabel">‚Äî</span>
        </span>
        <span class="chip">
          <span class="small">Date:</span>
          <input id="dateInput" type="date" />
        </span>
      </div>
    </header>

    <main>
      <!-- HOME VIEW -->
      <div id="view-home">
        <section class="card">
          <div class="label-sm">What‚Äôs next</div>
          <div id="nextList"></div>
        </section>

        <section class="card">
          <div class="label-sm">Morning inspiration</div>
          <div id="quoteText" class="quote">Loading‚Ä¶</div>
          <div class="row" style="margin-bottom:6px;">
            <button id="prevQuoteBtn" class="btn" style="flex:1;">‚Üê Previous</button>
            <button id="nextQuoteBtn" class="btn" style="flex:1;">Next ‚Üí</button>
          </div>
          <div class="label-sm">Morning focus</div>
          <input id="morningInput" class="field" placeholder="What‚Äôs the ONE thing that matters most today?" />
        </section>

        <section class="card">
          <div class="label-sm">Today‚Äôs tiny steps</div>
          <div id="categoriesContainer"></div>

          <div style="border-top:1px dashed #e5e7eb; margin-top:8px; padding-top:8px;">
            <div class="label-sm">Add a tiny step</div>
            <div class="row">
              <input id="addArea" class="field-area" placeholder="Area (e.g., Health)" />
              <input id="addTitle" class="field-area" placeholder="1% action (e.g., 5-min walk)" />
            </div>
            <div class="row" style="margin-top:6px;">
              <input id="addMinutes" class="field-area" placeholder="Minutes" type="number" min="1" style="max-width:80px;" />
              <input id="addBenefit" class="field-area" placeholder="Benefit (optional)" />
            </div>
            <div class="row-space" style="margin-top:6px;">
              <label class="small">
                <input id="addFavorite" type="checkbox" />
                <span>Mark as favorite</span>
              </label>
              <button id="addButton" class="btn-primary">Add step</button>
            </div>
            <div class="small" style="margin-top:4px;">New steps are saved and included in suggestions.</div>
          </div>
        </section>
      </div>

      <!-- CHECK-IN VIEW -->
      <div id="view-checkin" style="display:none;">
        <section class="card">
          <div class="label-sm">Mood check</div>
          <div class="moods">
            <span class="mood-btn" data-mood="angry">üò°</span>
            <span class="mood-btn" data-mood="sad">üòï</span>
            <span class="mood-btn" data-mood="neutral">üòê</span>
            <span class="mood-btn" data-mood="ok">üôÇ</span>
            <span class="mood-btn" data-mood="great">ü§©</span>
          </div>
          <div class="small">Tap how you feel right now.</div>
        </section>

        <section class="card">
          <div class="label-sm">Daily reflection</div>
          <textarea id="journalInput" class="field" placeholder="What‚Äôs on your mind today?"></textarea>
          <div class="small" style="margin-top:4px;">Auto-saved for this date only.</div>
        </section>

        <section class="card">
          <div class="label-sm">Evening gratitude</div>
          <input id="eveningInput" class="field" placeholder="What‚Äôs one thing you appreciated today?" />
        </section>
      </div>

      <!-- STATS VIEW -->
      <div id="view-stats" style="display:none;">
        <section class="card">
          <div class="label-sm">Your momentum</div>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-label">Streak (approx)</div>
              <div class="stat-value" id="streakValue">0 days</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Minutes this week</div>
              <div class="stat-value" id="minutesValue">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Reps this week</div>
              <div class="stat-value" id="repsValue">0</div>
            </div>
          </div>
        </section>

        <section class="card">
          <div class="label-sm">Last 14 days</div>
          <div class="small">Each box shows your daily % completed.</div>
          <div id="calendar" class="calendar"></div>
        </section>
      </div>
    </main>

    <nav>
      <div class="nav-btn active" data-view="home">
        <span class="nav-icon">üå§Ô∏è</span>
        <span>Home</span>
      </div>
      <div class="nav-btn" data-view="checkin">
        <span class="nav-icon">‚úçÔ∏è</span>
        <span>Check-In</span>
      </div>
      <div class="nav-btn" data-view="stats">
        <span class="nav-icon">üìä</span>
        <span>Stats</span>
      </div>
    </nav>
  </div>

<script>
  // ----- Data -----
  var QUOTES = [
    "Momentum beats motivation.",
    "Be where your feet are.",
    "Tiny shifts create big change.",
    "Each small step is a vote for who you‚Äôre becoming.",
    "Rest is part of progress.",
    "You don‚Äôt need a new life, you need a new day."
  ];

  // timeBlock hinting
  function getTimeBlock(date) {
    var d = date ? new Date(date) : new Date();
    var h = d.getHours();
    if (h < 10) return "Morning";
    if (h < 14) return "Midday";
    if (h < 18) return "Afternoon";
    if (h < 22) return "Evening";
    return "Night";
  }

  var DEFAULT_ACTIONS = [
    {
      id: "a1",
      area: "Health",
      title: "2-min cold plunge",
      benefit: "Boosts dopamine & resilience",
      minutes: 2,
      favorite: true,
      blocks: ["Morning"]
    },
    {
      id: "a2",
      area: "Health",
      title: "3 rounds Wim Hof breath",
      benefit: "Calms & energizes",
      minutes: 5,
      favorite: true,
      blocks: ["Morning"]
    },
    {
      id: "a3",
      area: "Fitness",
      title: "5-min stretch flow",
      benefit: "Mobility + posture",
      minutes: 5,
      favorite: true,
      blocks: ["Morning", "Afternoon"]
    },
    {
      id: "a4",
      area: "Spiritual",
      title: "10-min meditation sit",
      benefit: "Clears mental noise",
      minutes: 10,
      favorite: true,
      blocks: ["Evening"]
    },
    {
      id: "a5",
      area: "Family",
      title: "1 loving check-in with Anya",
      benefit: "Deepens bond",
      minutes: 2,
      favorite: true,
      blocks: ["Evening"]
    },
    {
      id: "a6",
      area: "Career",
      title: "Send 1 message to a lead",
      benefit: "Builds momentum",
      minutes: 3,
      favorite: false,
      blocks: ["Afternoon"]
    },
    {
      id: "a7",
      area: "Mindset",
      title: "Write 1 gratitude",
      benefit: "Shifts mindset",
      minutes: 2,
      favorite: true,
      blocks: ["Evening"]
    }
  ];

  var STORAGE_KEY = "onepct_better_v3_3_single";
  var state;
  try {
    state = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}");
  } catch (e) {
    state = {};
  }
  if (!state.actions) state.actions = DEFAULT_ACTIONS.slice();
  if (!state.days) state.days = {};
  if (typeof state.quoteIndex !== "number") state.quoteIndex = 0;

  var todayISO = new Date().toISOString().slice(0,10);
  var currentDate = state.currentDate || todayISO;

  // DOM
  var dateLabel = document.getElementById("dateLabel");
  var progressChip = document.getElementById("progressChip");
  var dateInput = document.getElementById("dateInput");
  var timeBlockLabel = document.getElementById("timeBlockLabel");
  var nextList = document.getElementById("nextList");
  var quoteText = document.getElementById("quoteText");
  var prevQuoteBtn = document.getElementById("prevQuoteBtn");
  var nextQuoteBtn = document.getElementById("nextQuoteBtn");
  var morningInput = document.getElementById("morningInput");
  var categoriesContainer = document.getElementById("categoriesContainer");
  var addArea = document.getElementById("addArea");
  var addTitle = document.getElementById("addTitle");
  var addMinutes = document.getElementById("addMinutes");
  var addBenefit = document.getElementById("addBenefit");
  var addFavorite = document.getElementById("addFavorite");
  var addButton = document.getElementById("addButton");
  var eveningInput = document.getElementById("eveningInput");
  var journalInput = document.getElementById("journalInput");
  var moodButtons = document.querySelectorAll(".mood-btn");
  var streakValue = document.getElementById("streakValue");
  var minutesValue = document.getElementById("minutesValue");
  var repsValue = document.getElementById("repsValue");
  var calendarEl = document.getElementById("calendar");

  function saveState() {
    state.currentDate = currentDate;
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    } catch (e) {}
  }

  function ensureDay(date) {
    if (!state.days[date]) {
      state.days[date] = {
        done: {},
        morning: "",
        evening: "",
        journal: "",
        mood: null
      };
    }
    return state.days[date];
  }

  function formatDateLabel(date) {
    var d = new Date(date);
    return d.toLocaleDateString(undefined, { weekday: "short", month: "short", day: "numeric" });
  }

  function render() {
    var day = ensureDay(currentDate);
    dateLabel.textContent = "Today: " + formatDateLabel(currentDate);
    timeBlockLabel.textContent = getTimeBlock();
    dateInput.value = currentDate;

    // quotes
    if (state.quoteIndex < 0) state.quoteIndex = 0;
    if (state.quoteIndex >= QUOTES.length) state.quoteIndex = QUOTES.length - 1;
    quoteText.textContent = "‚Äú" + QUOTES[state.quoteIndex] + "‚Äù";

    morningInput.value = day.morning || "";
    eveningInput.value = day.evening || "";
    journalInput.value = day.journal || "";

    // moods
    moodButtons.forEach(function(btn) {
      btn.classList.toggle("active", btn.dataset.mood === day.mood);
    });

    renderTasks(day);
    renderProgress(day);
    renderNext(day);
    renderStats();
    renderCalendar();
  }

  function getActions() {
    if (!Array.isArray(state.actions) || !state.actions.length) {
      state.actions = DEFAULT_ACTIONS.slice();
    }
    return state.actions;
  }

  function renderTasks(day) {
    categoriesContainer.innerHTML = "";
    var actions = getActions();
    var byArea = {};
    actions.forEach(function(a) {
      if (!byArea[a.area]) byArea[a.area] = [];
      byArea[a.area].push(a);
    });
    Object.keys(byArea).sort().forEach(function(area) {
      var tasks = byArea[area];
      var header = document.createElement("div");
      header.className = "area-header";
      var t = document.createElement("div");
      t.className = "area-title";
      t.textContent = area;
      var meta = document.createElement("div");
      meta.className = "area-meta";
      var doneCount = tasks.filter(function(x){ return !!day.done[x.id]; }).length;
      meta.textContent = doneCount + " / " + tasks.length + " done";
      header.appendChild(t);
      header.appendChild(meta);
      categoriesContainer.appendChild(header);

      tasks.forEach(function(task) {
        var row = document.createElement("label");
        row.className = "task";

        var cb = document.createElement("input");
        cb.type = "checkbox";
        cb.checked = !!day.done[task.id];
        cb.addEventListener("change", function() {
          var d = ensureDay(currentDate);
          d.done[task.id] = cb.checked;
          saveState();
          render();
        });

        var body = document.createElement("div");
        body.className = "task-body";

        var titleRow = document.createElement("div");
        titleRow.className = "task-title-row";
        var titleSpan = document.createElement("span");
        titleSpan.textContent = task.title;
        titleRow.appendChild(titleSpan);

        if (task.favorite) {
          var fav = document.createElement("span");
          fav.className = "pill pill-fav";
          fav.textContent = "favorite";
          titleRow.appendChild(fav);
        }
        var mins = document.createElement("span");
        mins.className = "pill";
        mins.textContent = (task.minutes || 1) + " min";
        titleRow.appendChild(mins);

        var benefit = document.createElement("div");
        benefit.className = "task-benefit";
        benefit.textContent = task.benefit || "";

        body.appendChild(titleRow);
        body.appendChild(benefit);

        row.appendChild(cb);
        row.appendChild(body);
        categoriesContainer.appendChild(row);
      });
    });
  }

  function renderProgress(day) {
    var actions = getActions();
    var total = actions.length;
    var done = actions.filter(function(a){ return !!day.done[a.id]; }).length;
    var pct = total ? Math.round(done / total * 100) : 0;
    progressChip.textContent = "Today: " + pct + "% (" + done + "/" + total + ")";
  }

  function renderNext(day) {
    nextList.innerHTML = "";
    var actions = getActions();
    if (!actions.length) {
      nextList.innerHTML = '<div class="small">Add a tiny step below to get started.</div>';
      return;
    }
    var block = getTimeBlock();
    var undone = actions.filter(function(a){ return !day.done[a.id]; });
    var pool = undone.length ? undone : actions.slice();

    pool = pool.filter(function(a){
      if (!a.blocks || !a.blocks.length) return true;
      return a.blocks.indexOf(block) >= 0;
    });

    pool.sort(function(a,b){
      var sa = (a.favorite ? 2 : 0);
      var sb = (b.favorite ? 2 : 0);
      return sb - sa;
    });

    pool.slice(0,3).forEach(function(t) {
      var div = document.createElement("div");
      div.className = "next-item";
      var left = document.createElement("div");
      var title = document.createElement("div");
      title.className = "next-item-title";
      title.textContent = t.title;
      var desc = document.createElement("div");
      desc.className = "small";
      desc.textContent = t.benefit || "";
      left.appendChild(title);
      left.appendChild(desc);

      var right = document.createElement("div");
      right.className = "next-side";
      var mins = document.createElement("div");
      mins.textContent = (t.minutes || 1) + " min";
      right.appendChild(mins);
      if (t.favorite) {
        var bf = document.createElement("div");
        bf.className = "badge-focus";
        bf.textContent = "Priority";
        right.appendChild(bf);
      }

      div.appendChild(left);
      div.appendChild(right);
      nextList.appendChild(div);
    });
  }

  function renderStats() {
    // rough streak = count of consecutive days (ending today) with any completion
    var dates = Object.keys(state.days).sort();
    var streak = 0;
    if (dates.length) {
      var cursor = new Date(currentDate);
      while (true) {
        var key = cursor.toISOString().slice(0,10);
        var day = state.days[key];
        if (!day) break;
        var anyDone = Object.values(day.done || {}).some(Boolean);
        if (!anyDone) break;
        streak++;
        cursor.setDate(cursor.getDate() - 1);
      }
    }
    streakValue.textContent = streak + " day" + (streak === 1 ? "" : "s");

    // minutes / reps this week (Mon-Sun relative to currentDate's week)
    var base = new Date(currentDate);
    var dayOfWeek = base.getDay(); // 0=Sun
    var monday = new Date(base);
    monday.setDate(base.getDate() - ((dayOfWeek + 6) % 7)); // previous Monday
    var sunday = new Date(monday);
    sunday.setDate(monday.getDate() + 6);

    var mins = 0;
    var reps = 0;
    var actions = getActions();
    for (var d = new Date(monday); d <= sunday; d.setDate(d.getDate()+1)) {
      var key = d.toISOString().slice(0,10);
      var day = state.days[key];
      if (!day) continue;
      actions.forEach(function(a){
        if (day.done[a.id]) {
          mins += (a.minutes || 0);
          if (a.reps) reps += a.reps;
        }
      });
    }
    minutesValue.textContent = mins;
    repsValue.textContent = reps;
  }

  function renderCalendar() {
    calendarEl.innerHTML = "";
    var actions = getActions();
    for (var i = 13; i >= 0; i--) {
      var d = new Date();
      d.setDate(d.getDate() - i);
      var key = d.toISOString().slice(0,10);
      var day = state.days[key] || { done: {} };
      var total = actions.length || 1;
      var doneCount = actions.filter(function(a){ return !!day.done[a.id]; }).length;
      var pct = Math.round(doneCount / total * 100);

      var cell = document.createElement("div");
      cell.className = "cal-day";
      cell.textContent = pct + "%";
      // shade by pct
      var light = 100 - Math.round(pct * 0.4);
      cell.style.background = "hsl(150, 70%," + light + "%)";
      calendarEl.appendChild(cell);
    }
  }

  // events
  dateInput.addEventListener("change", function() {
    var v = dateInput.value || todayISO;
    currentDate = v;
    ensureDay(currentDate);
    saveState();
    render();
  });

  prevQuoteBtn.addEventListener("click", function() {
    state.quoteIndex = (state.quoteIndex + QUOTES.length - 1) % QUOTES.length;
    saveState();
    render();
  });
  nextQuoteBtn.addEventListener("click", function() {
    state.quoteIndex = (state.quoteIndex + 1) % QUOTES.length;
    saveState();
    render();
  });

  morningInput.addEventListener("input", function() {
    var day = ensureDay(currentDate);
    day.morning = morningInput.value;
    saveState();
  });
  eveningInput.addEventListener("input", function() {
    var day = ensureDay(currentDate);
    day.evening = eveningInput.value;
    saveState();
  });
  journalInput.addEventListener("input", function() {
    var day = ensureDay(currentDate);
    day.journal = journalInput.value;
    saveState();
  });

  moodButtons.forEach(function(btn) {
    btn.addEventListener("click", function() {
      var day = ensureDay(currentDate);
      day.mood = btn.dataset.mood;
      saveState();
      render();
    });
  });

  addButton.addEventListener("click", function() {
    var area = addArea.value.trim() || "General";
    var title = addTitle.value.trim();
    if (!title) return;
    var minutes = parseInt(addMinutes.value, 10);
    if (!minutes || minutes <= 0) minutes = 3;
    var benefit = addBenefit.value.trim() || "Supports your long-term vision.";
    var favorite = addFavorite.checked;
    var id = "u" + Date.now() + Math.floor(Math.random()*1000);
    state.actions.push({
      id: id,
      area: area,
      title: title,
      benefit: benefit,
      minutes: minutes,
      favorite: favorite
    });
    addArea.value = "";
    addTitle.value = "";
    addMinutes.value = "";
    addBenefit.value = "";
    addFavorite.checked = false;
    saveState();
    render();
  });

  // nav switching
  var views = {
    home: document.getElementById("view-home"),
    checkin: document.getElementById("view-checkin"),
    stats: document.getElementById("view-stats")
  };
  var navBtns = document.querySelectorAll(".nav-btn");
  navBtns.forEach(function(btn) {
    btn.addEventListener("click", function() {
      var v = btn.dataset.view;
      Object.keys(views).forEach(function(key){
        views[key].style.display = (key === v) ? "block" : "none";
      });
      navBtns.forEach(function(b){ b.classList.toggle("active", b === btn); });
    });
  });

  // init
  dateInput.value = currentDate;
  render();
</script>
</body>
</html>
