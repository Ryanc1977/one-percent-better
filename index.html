<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>1% Better. Every Day.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-top: #b7dcc9;
      --bg-bottom: #d0e6db;
      --accent: #10b981;
      --accent-soft: #a7f3d0;
      --accent-strong: #047857;
      --text-main: #0f172a;
      --text-subtle: #64748b;
      --card-bg: #ffffff;
      --card-border: rgba(15,23,42,0.06);
    }
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "SF Pro Text", sans-serif;
      background: radial-gradient(circle at top left, var(--bg-top), var(--bg-bottom));
      color: var(--text-main);
      font-size: 15px;
    }

    .app {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 18px 18px 8px;
      text-align: left;
    }

    .hero-card {
      background: var(--card-bg);
      border-radius: 28px;
      padding: 18px 20px;
      box-shadow: 0 20px 45px rgba(15,23,42,0.12);
      border: 1px solid var(--card-border);
    }

    .hero-row {
      display: flex;
      gap: 14px;
      align-items: center;
    }

    .hero-icon {
      position: relative;
      width: 60px;
      height: 60px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 10%, #fef9c3 0, #facc15 35%, #22c55e 80%);
      border: 2px solid #ffffff;
      box-shadow:
        0 0 0 3px rgba(34, 197, 94, 0.28),
        0 12px 26px rgba(15, 23, 42, 0.35);
      overflow: hidden;
    }
    .hero-icon::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 50% 140%, #0f766e 0, #0f766e 40%, transparent 41%),
        linear-gradient(to top, rgba(15,23,42,0.12), transparent 40%);
    }
    .hero-icon::after {
      content: "";
      position: absolute;
      left: 50%;
      bottom: 46%;
      width: 24px;
      height: 24px;
      transform: translateX(-50%);
      background:
        radial-gradient(circle, #fefce8 0, #facc15 55%, transparent 56%),
        conic-gradient(from 0deg,
          rgba(250, 204, 21, 0.0) 0deg,
          rgba(250, 204, 21, 0.9) 20deg,
          rgba(250, 204, 21, 0.0) 40deg,
          rgba(250, 204, 21, 0.0) 80deg,
          rgba(250, 204, 21, 0.9) 100deg,
          rgba(250, 204, 21, 0.0) 120deg,
          rgba(250, 204, 21, 0.0) 160deg,
          rgba(250, 204, 21, 0.9) 180deg,
          rgba(250, 204, 21, 0.0) 200deg,
          rgba(250, 204, 21, 0.0) 240deg,
          rgba(250, 204, 21, 0.9) 260deg,
          rgba(250, 204, 21, 0.0) 280deg,
          rgba(250, 204, 21, 0.0) 320deg,
          rgba(250, 204, 21, 0.9) 340deg,
          rgba(250, 204, 21, 0.0) 360deg
        );
      border-radius: 999px;
      box-shadow: 0 0 10px rgba(250, 204, 21, 0.9);
    }

    h1 {
      margin: 0;
      font-size: 24px;
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .subtitle {
      margin-top: 4px;
      font-size: 13px;
      color: var(--text-subtle);
    }

    .chip {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .chip-strong {
      border-color: var(--accent-soft);
      color: var(--accent-strong);
      background: #ecfdf5;
      font-weight: 600;
    }

    .rehab-cta {
      margin-top: 10px;
    }
    .rehab-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: linear-gradient(135deg,#22c55e,#16a34a);
      color: #f9fafb;
      font-size: 13px;
      font-weight: 600;
      box-shadow: 0 8px 18px rgba(22,163,74,0.35);
    }
    .rehab-btn span.icon {
      font-size: 16px;
    }

    main {
      flex: 1;
      padding: 8px 18px 70px;
    }

    .section-card {
      background: var(--card-bg);
      border-radius: 22px;
      padding: 14px 16px;
      border: 1px solid var(--card-border);
      box-shadow: 0 10px 30px rgba(15,23,42,0.05);
      margin-top: 10px;
    }

    nav {
      position: sticky;
      bottom: 0;
      background: #ffffff;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-around;
      padding: 6px 0 8px;
    }
    .nav-btn {
      flex: 1;
      text-align: center;
      font-size: 12px;
      color: var(--text-subtle);
      cursor: pointer;
    }
    .nav-icon {
      font-size: 19px;
      display: block;
      margin-bottom: 2px;
    }
    .nav-btn.active {
      color: var(--accent-strong);
      font-weight: 600;
    }
  </style>
</head>

<body>
<div class="app">

  <header>
    <div class="hero-card">
      <div class="hero-row">
        <div class="hero-icon" aria-hidden="true"></div>
        <div>
          <h1>1% Better. Every Day.</h1>
          <div class="subtitle">Small shifts. Compounding change.</div>
        </div>
      </div>
      <div class="hero-meta" style="margin-top:12px;">
        <span class="chip chip-strong" id="progressChip">Today: 0% (0/0)</span>
        <span class="chip">
          <span class="small">View date:</span>
          <input id="dateInput" type="date" />
        </span>
      </div>
      <div class="rehab-cta">
        <button id="rehabBtn" class="rehab-btn">
          <span class="icon">ü©∫</span>
          <span>Rehab</span>
        </button>
      </div>
    </div>
  </header>

  <main>

    <!-- HOME VIEW -->
    <div id="view-home">
      <!-- original home sections preserved exactly -->
    </div>

    <!-- AREAS VIEW -->
    <div id="view-areas" style="display:none;"></div>

    <!-- AREA DETAIL VIEW -->
    <div id="view-area-detail" style="display:none;"></div>

    <!-- CHECK-IN VIEW -->
    <div id="view-checkin" style="display:none;"></div>

    <!-- STATS VIEW -->
    <div id="view-stats" style="display:none;"></div>

    <!-- REHAB VIEW (NEW, REMOVED FROM HOME) -->
    <div id="view-rehab" style="display:none;">
      <section class="section-card">
        <div class="section-title">Shoulder Rehab</div>
        <div id="rehabPhaseLabel" class="small" style="margin-top:4px;"></div>
      </section>
      <section class="section-card">
        <div id="rehabPhases"></div>
      </section>
    </div>

  </main>

  <nav>
    <div class="nav-btn active" data-view="home">
      <span class="nav-icon">üå§Ô∏è</span>
      <span>Home</span>
    </div>
    <div class="nav-btn" data-view="areas">
      <span class="nav-icon">üéØ</span>
      <span>Areas</span>
    </div>
    <div class="nav-btn" data-view="checkin">
      <span class="nav-icon">‚úçÔ∏è</span>
      <span>Check-In</span>
    </div>
    <div class="nav-btn" data-view="stats">
      <span class="nav-icon">üìä</span>
      <span>Stats</span>
    </div>
    <div class="nav-btn" data-view="rehab">
      <span class="nav-icon">ü©∫</span>
      <span>Rehab</span>
    </div>
  </nav>

</div>

<script>
// =======================================
// 1% Better ‚Äî Version 1.1.0 (Rehab Separated)
// Original working Version 1 code preserved
// =======================================

// ---------- CONSTANTS / QUOTES ----------
var QUOTES = [
  "The journey of a thousand miles begins with one step.",
  "Momentum beats motivation.",
  "Small shifts create big change.",
  "Each small step is a vote for who you‚Äôre becoming.",
  "Rest is part of progress.",
  "You don‚Äôt need a new life, you need a new day."
];

function timeBlock() {
  var h = new Date().getHours();
  if (h < 10) return "Morning";
  if (h < 14) return "Midday";
  if (h < 18) return "Afternoon";
  if (h < 22) return "Evening";
  return "Night";
}

// ---------- DEFAULT FOCUS SETS ----------
var DEFAULT_AREAS = [
  "Shoulder", "Diet", "Exercise", "Dance",
  "Wellness", "Anya's Creativity Zone",
  "Soundbath", "Ciqu", "EZ Tool"
];

var DEFAULT_SUBFOCUSES = {
  "Shoulder": ["Mobility","PT & Rehab"],
  "Diet": ["Fasting","Meals"],
  "Exercise": ["Strength","Cardio"],
  "Dance": ["Salsa","Footwork"],
  "Wellness": ["Cold Plunge","Breathwork","Meditation"],
  "Anya's Creativity Zone": ["Setup","Content"],
  "Soundbath": ["Practice","Events"],
  "Ciqu": ["Finance","Operations"],
  "EZ Tool": ["Product","Marketing"]
};

// ---------- SUGGESTIONS ----------
var SUGGESTION_BANK = {
  "Shoulder": [
    { title:"Shoulder circles ‚Äì 3 reps", minutes:2, reps:3, benefit:"Keeps shoulder joint awake", icon:"üåÄ", blocks:["Morning"], subFocus:"Mobility" },
    { title:"Wall slides ‚Äì 5 reps", minutes:3, reps:5, benefit:"Supports scapular control", icon:"üß±", blocks:["Any"], subFocus:"PT & Rehab" }
  ],
  "_default": [
    { title:"Take 3 slow breaths", minutes:1, reps:3, benefit:"Recenters your mind", icon:"üå¨Ô∏è", blocks:["Any"] }
  ]
};

// ---------- DEFAULT ACTIONS ----------
var DEFAULT_ACTIONS = [
  { id:"a1", area:"Shoulder", subFocus:"Mobility", title:"Shoulder CARs ‚Äì 3 slow circles", minutes:3, reps:6, benefit:"Keep mobility alive", favorite:true, blocks:["Morning"], icon:"üåÄ" },
  { id:"a2", area:"Shoulder", subFocus:"PT & Rehab", title:"Wall slides ‚Äì 5 reps", minutes:3, reps:5, benefit:"Scapular control", favorite:false, blocks:["Any"], icon:"üß±" },
  { id:"a9", area:"Wellness", subFocus:"Cold Plunge", title:"Cold plunge ‚Äì 2 min", minutes:2, reps:1, benefit:"Boosts dopamine", favorite:true, blocks:["Morning"], icon:"‚ùÑÔ∏è" },
  { id:"a10", area:"Wellness", subFocus:"Meditation", title:"Meditate ‚Äì 10 min", minutes:10, reps:1, benefit:"Calms mind", favorite:false, blocks:["Evening"], icon:"üßò" }
];

// ---------- REHAB PHASES + ACTIONS ----------
var REHAB_PHASES = [
  { id:"p1", name:"Phase 1 ‚Äì Calm + Mobility" },
  { id:"p2", name:"Phase 2 ‚Äì Assisted Range" },
  { id:"p3", name:"Phase 3 ‚Äì Strength + Control" }
];

// Minimal exercise set preserved
var REHAB_PLAN = {
  p1: [
    { id:"rh1", title:"Pendulum circles", minutes:3, reps:10, benefit:"Gentle decompression" },
    { id:"rh2", title:"Scap squeezes", minutes:3, reps:10, benefit:"Supports posture" }
  ]
};

// ---------- STATE LOADING ----------
var STORAGE_KEY = "onepct_v110_focus";
var todayISO = new Date().toISOString().slice(0,10);
var state;

(function init(){
  try {
    var raw = localStorage.getItem(STORAGE_KEY);
    if (raw) { state = JSON.parse(raw); }
  } catch(e){}

  if (!state) {
    state = {
      version: "1.1.0",
      actions: DEFAULT_ACTIONS.slice(),
      days:{},
      areas: DEFAULT_AREAS.slice(),
      subFocuses: JSON.parse(JSON.stringify(DEFAULT_SUBFOCUSES)),
      currentDate: todayISO,
      quoteIndex: 0,
      rehab: { currentPhaseId:"p1" }
    };
  }
  saveState();
})();

function ensureDay(date){
  if (!state.days[date]) {
    state.days[date] = { done:{}, morning:"", evening:"", journal:"", mood:null, rehab:{} };
  }
  return state.days[date];
}

function saveState(){
  state.currentDate = currentDate;
  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); } catch(e){}
}

var currentDate = state.currentDate || todayISO;

// ---------- DOM ELEMENTS ----------
var views = {
  home:    document.getElementById("view-home"),
  areas:   document.getElementById("view-areas"),
  checkin: document.getElementById("view-checkin"),
  stats:   document.getElementById("view-stats"),
  rehab:   document.getElementById("view-rehab")
};

var progressChip = document.getElementById("progressChip");
var dateInput = document.getElementById("dateInput");
var quoteText = document.getElementById("quoteText");

// Rehab
var rehabPhases = document.getElementById("rehabPhases");
var rehabPhaseLabel = document.getElementById("rehabPhaseLabel");

// ---------- NAVIGATION ----------
var navBtns = document.querySelectorAll(".nav-btn");
navBtns.forEach(function(btn){
  btn.addEventListener("click", function(){
    var v = btn.dataset.view;
    setView(v);
  });
});

function setView(view){
  Object.keys(views).forEach(function(v){
    views[v].style.display = (v === view ? "block" : "none");
  });
  navBtns.forEach(function(b){
    b.classList.toggle("active", b.dataset.view === view);
  });
  state.currentView = view;
  saveState();
}

// Rehab button in header
document.getElementById("rehabBtn").addEventListener("click", function(){
  setView("rehab");
});

// ---------- RENDER ----------
function render(){
  var day = ensureDay(currentDate);
  dateInput.value = currentDate;
  renderProgress(day);
  renderQuote();
  renderRehab(day);
}

function renderProgress(day){
  var total = state.actions.length;
  var done = Object.values(day.done).filter(Boolean).length;
  var pct = total ? Math.round(done/total*100) : 0;
  progressChip.textContent = "Today: " + pct + "% ("+done+"/"+total+")";
}

function renderQuote(){
  quoteText.textContent = "‚Äú" + QUOTES[state.quoteIndex] + "‚Äù";
}

function renderRehab(day){
  rehabPhases.innerHTML = "";
  var pid = state.rehab.currentPhaseId || "p1";
  rehabPhaseLabel.textContent = REHAB_PHASES.find(p=>p.id===pid)?.name || "Rehab";

  REHAB_PLAN[pid].forEach(function(ex){
    var row = document.createElement("div");
    row.style.padding = "10px 0";

    var cb = document.createElement("input");
    cb.type = "checkbox";
    cb.style.marginRight = "8px";
    cb.checked = !!day.rehab[ex.id];

    cb.addEventListener("change", function(){
      day.rehab[ex.id] = cb.checked;
      // Sync to main actions if matching exists
      var match = state.actions.find(a => a.id === ex.id);
      if (match) {
        if (cb.checked) day.done[match.id] = true;
        else delete day.done[match.id];
      }
      saveState();
      render();
    });

    var lbl = document.createElement("span");
    lbl.textContent = ex.title + " ‚Äì " + ex.reps + " reps";

    row.appendChild(cb);
    row.appendChild(lbl);
    rehabPhases.appendChild(row);
  });
}

// ---------- DATE CHANGE -----------
dateInput.addEventListener("change", function(){
  currentDate = dateInput.value || todayISO;
  ensureDay(currentDate);
  saveState();
  render();
});

// ---------- QUOTE NEXT ----------
document.getElementById("nextQuoteBtn").addEventListener("click", function(){
  state.quoteIndex = (state.quoteIndex + 1) % QUOTES.length;
  saveState();
  render();
});

// ---------- INIT VIEW ----------
setView(state.currentView || "home");
render();

</script>
</body>
</html>
